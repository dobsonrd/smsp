TRUD Document,Requirement Ref,Area,Title,Description,Applicability,Type,Compliance Status,Guidance on Appropriate Test Evidence and Comments,Additional Notes,Link,Description from previous set of Architecture Specifications ,System Type,Bundle,Transport,Category
Accreditation,ACC-GEN-01,ACC-RTS-01,Suppliers MUST confirm they are aware of ALL relevant requirements,"1
This speadsheet does not contain all the requirements defined in the ITK specifications. A full list of requirements is shown on the 'Cover' sheet, marked 'base nn'. Suppliers MUST confirm that all relevant requirements not listed in the spreadsheet  are met 
2
guidance MUST be sought rom HSCIC for any requirements that are not met.",Always applies,Must,SELECT ONE,"STATEMENT:   A statement of compliance simply confirming that the requirement is met. Or detail any discussions with HSCIC on requirements not met and agreed outcomes.
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ",,,,ALL,ALL,ALL,1
"ITK Client, Host and ITK Middleware Requirements",COR-SUP-01,Documentation,Toolkit Implementations MUST provide message payload content in the Distribution Envelope,"NB
For HL7v2 content then the Service Definition artefacts define both an XML representation and a pipe-and-hat representation of this same content. While the XML representation is the preferred strategic direction, the pipe-and-hat representation is also acceptable.
",Always applies,Must,SELECT ONE,"EVIDENCE: Execute all tests marked as ""applicable""  after filters have been applied on the Testcases Index  tab. 
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: 
","This requirement applies to: 
All Client Applications
All Middleware  
All Host Applications 
SMSP Host

NOTE: For Host applications both Pipe-and-Hat and XML representations must be supported. TKW provides a transform is provided so that systems presented for ITK accreditation,which use pipe-and-hat formats only, can prepare their message samples for the XML-based ITK Testbench validation suite. This can be found in ...\TKW\contrib\Additional_Tools\PHconverter when TKW is installed.",,"It is likely that, historically, applications have provided interfaces in a format that is different from the Toolkit standards.
In order to meet the requirements for Toolkit readiness, all Toolkit Implementations MUST instead provide message payload content in line with the Toolkit standards
Note that this requirement relates to the message payload content only. The use of Toolkit transport protocols and wrappers (ie Web Services) is the subject of separate requirement statements
Note that for HL7v2 content then the Service Definition artefacts (see [8], [9])  define both an XML representation and a pipe-and-hat representation of this same content. While the XML representation is the preferred strategic direction, the pipe-and-hat representation is also acceptable.
",ALL,ALL,ALL,1
"ITK Client, Host and ITK Middleware Requirements",COR-SUP-03,Documentation,"Toolkit Implementations MUST provide design-time
documentation describing the services available","NB
Design time documentation may include solution overviews, solution architecture diagrams etc.",Always applies.,Must,SELECT ONE,"STATEMENT:  The statement  should describe how this requirement has been handled for example referring out to a user guide or  registry of services within the product.
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to: 
All Client Applications
All Middleware  
All Host Applications
SMSP Host

NOTE: The Services that will be available (and accredited) in your product, should be agreed with the ITK Accreditation Team and included in your Design Time Documentation. For a Client Application, this will include all messages that are created by your product. For a Host Application, this will include messages that can be received by your product - identifying any messages in a bundle that are received but not actioned.",,"Documentation is necessary so that developers of requestor applications know what is available and how to make use of it. If a Registry and Repository are provided, then it likely that there will be a user interface allowing developers to browse and query the actual configuration details. Failing this, at the very least manual documentation (eg PDF or Word files) must be provided and kept up-to-date.",ALL,ALL,ALL,1
ITK Distribution Envelope Requirements,COR-DEH-01,Distribution Envelope Header–General Requirements,The Distribution Envelope Header “service” attribute MUST contain the value specified within the respective domain message specification.,,"Always applies to systems creating  the distribution envelope.

",Must,SELECT ONE,"EVIDENCE: Execute all tests marked as ""applicable""  after filters have been applied on the Testcases Index  tab. 
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: 
","This requirement applies to: 
All Client Applications
Middleware creating an infrastructure acknowledgement i.e. a NACK produced as the result of a routing failure. 
Host Applications that support routable services i.e. Correspondence, Telehealth and HSCI as they create acknowledgements.
SMSP Host

NOTE: All validation checks performed by the TKW test that the Distribution Envelope Header “service” attribute contains the original SOAP Action requested, therefore successful validation reports prove implementation. There is also a negative test case defined to ensure the host validation functions as expected (DE_INVSER).",,"Where a distribution goes via a path involving multiple routing “hops”, this allows the service name to be recreated.
For example:
  • A SOAP 1.1 web service call may be received, the SOAP Headers removed, and the SOAP Body (alone) queued for further processing
  • A call may be “tunnelled” via a non-SOAP inter-router distribution service, as part of a multi-hop routing process
The “service” attribute thus captures the original SOAP Action, allowing it to be restored to the SOAP Header for final delivery.

",MW&ACK; CLIENT; HOST& ACK; SMSP HOST; ,ALL,ALL,30
ITK Distribution Envelope Requirements,COR-DEH-02,Distribution Envelope Header–General Requirements,The Distribution Envelope Header “trackingid” attribute MUST be populated with a unique uuid for each end-to-end distribution request,"1
The uuid MUST be formatted into 5 hyphen-separated groups of hexadecimal digits having 8, 4, 4, 4, and 12 places respectively, and the hexadecimal digits A-F in UUIDs MUST be in upper case.

The trackingid MUST contain the uuid only.

Specifically there MUST NOT be any prefixes such as “urn:” or “uuid:” However if subsequent processing leads to further messages being exchanged as part of a business workflow, these messages MUST each have different trackingids of their own.","Always applies to systems creating  the distribution envelope.

",Must,SELECT ONE," STATEMENT: Please provide a statement of compliance confirming that subsequent business workflow related messages each have different trackingids.   

EVIDENCE: Execute all tests marked as ""applicable""  after filters have been applied on the Testcases Index  tab. 
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: 
","This requirement applies to: 
All Client Applications
Middleware creating an infrastructure acknowledgement i.e. a NACK produced as the result of a routing failure. 
Host Applications that support routable services i.e. Correspondence, Telehealth and HSCI as they create acknowledgements
SMSP Host",,"This allows for unique identification of each distribution – for example for logging and diagnostics.
The uuid MUST be formatted into 5 hyphen-separated groups of hexadecimal digits having 8, 4, 4, 4, and 12 places respectively, and the hexadecimal digits A-F in UUIDs MUST be in upper case. The trackingid MUST contain the uuid only. Specifically there MUST NOT be any prefixes such as  “urn:” or “uuid:”
The scope of a “distribution” is from the original sender to the final recipient(s).
For example, suppose a message is sent from App A to App B, via the Toolkit Middleware. This journey consists of two messaging “hops”, which would have different MessageIds in the transport headers, but the same trackingid in the Distribution Envelope. Thus the trackingid assists with end-to-end diagnostic investigations, without having to trace all steps in the chain.
If a message is broadcast to multiple destinations then all branches of the multicast MUST also have the same trackingid.
However if subsequent processing leads to further messages being exchanged as part of a business workflow, these messages MUST each have different trackingids of their own.",MW&ACK; CLIENT; HOST& ACK; SMSP HOST; ,ALL,ALL,30
ITK Distribution Envelope Requirements,COR-DEH-03,Distribution Envelope Header–General Requirements,For services using the Distribution Envelope and requiring an Audit Identity then Service Clients MUST populate the Audit Identity of the originating user ,"1
Systems populating the auditIdentity MUST guarantee an authenticated relationship between the identity and a user or source system.
2
This authentication SHOULD be strong authentication (e.g. smart card) but MUST at least be via personal login via a password created and maintained in a suitably-strong manner.
3
“Unattended” systems or those with no specific users MUST be secured. Whilst a remote system need not be able to resolve auditIdentity values directly, a populating system MUST be able to trace the source of a request to a specific local user or event.","Always applies to systems creating  the distribution envelope.

",Must,SELECT ONE,"EVIDENCE:Execute all tests marked as ""applicable""  after filters have been applied on the Testcases Index  tab. 
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: 

","This requirement applies to: 
All Client Applications
Middleware creating an infrastructure acknowledgement i.e. a NACK produced as the result of a routing failure. 
Host Applications that support routable services i.e. Correspondence, Telehealth and HSCI as they create acknowledgements.
SMSP Host

NOTE: Currently ALL services require the population of the Audit Identity.

NOTE: Please refer to the distribution envelope description for the service domains being implemented within the ITK Specifications that are held on TRUD (Refer Link), 
the Audit Identity cardinality is defined within this description. If there is no description, then the core distribution envelope description takes precedence.
",TRUD,"This allows the identity of the originating user to be propagated throughout the end-to-end distribution, thus enabling audit logs to be recorded at any point along the way.

Whether or not an Audit Identity is required is a per-service decision. Depending on the functionality involved, it may be necessary for some services but not for others

  • For messages which use the Distribution Envelope then Web Service Client Applications MUST populate the Audit Identity for those services where it is specified that the Audit Identity is required. The per-service specification of audit requirements will also indicate whether a unique user-id or a system-id is required
  • For other services where it is not specified that the Audit Identity is required then it MAY be omitted
",MW&ACK; CLIENT; HOST& ACK; SMSP HOST; ,ALL,ALL,30
ITK Distribution Envelope Requirements,COR-DEH-04,Distribution Envelope Header–General Requirements,Distribution Envelope Header “auditIdentity/id” element SHOULD contain a Toolkit identity URI,"1
The identity representation MUST consist of a printable ASCII string, conformant with the XML Schema anyURI data type (http://www.w3.org/TR/2004/REC-xmlschema-2-20041028/#anyURI). e.g. uri=""urn:nhs-uk:identity:ods:rhm:team1:C""
2
The following prefix MUST be used to indicate a Toolkit urn:nhs-uk:identity:
3
For a Toolkit identity: The remainder of the address MUST consist of an arbitrarily-long sequence of colon-delimited tokens. The tokens MUST represent a hierarchy with the highest level on the left and the lowest level on the right.
4
The first token MUST identify a HSCIC approved naming authority.
5
The second token MUST be a unique organisation identifier, allocated by that naming authority.
6
Subsequent token(s) MAY be locally allocated by the named organisation. That organisation MUST ensure that the uniqueness of the identity is preserved. Note that the precise content and meaning of this local identity information is not prescribed, rather each organisation MUST define their own internal identity namespace – based on their business operations and the entities that need to be identified.
7
If the address is a non-Toolkit address then the “type” attribute MUST be populated with an OID to indicate the address type.
NB: A Spine smartcard user role profile is another anticipated possibility which MAY be used.
NB
Example Toolkit Identity: urn:nhs-uk:identity:ods:REC:fbloggs 
Note that while the system recording the audit trail may not have direct access to the directory which provides details of the identified user, the initial organisational part of the identity will provide enough detail to enable enquiries to find these details out.","Always applies to systems creating  the distribution envelope.

",Should,SELECT ONE,"EVIDENCE:Execute all tests marked as ""applicable""  after filters have been applied on the Testcases Index  tab. 
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to: 
All Client Applications
Middleware creating an infrastructure acknowledgement i.e. a NACK produced as the result of a routing failure. 
Host Applications that support routable services i.e. Correspondence, Telehealth and HSCI as they create acknowledgements.
SMSP Host

NOTE: Currently ALL services require the population of the Audit Identity.

NOTE: Please refer to the distribution envelope description for the service domains being implemented within the ITK Specifications that are held on TRUD (Refer Link), 
the Audit Identity cardinality is defined within this description. If there is no description, then the core distribution envelope description takes precedence.

NOTE: The example provided in the requirement: ""urn:nhs-uk:identity:ods:REC:fbloggs""
can be used for testing purposes. The actual value in Live will be dependent on each deployment.",TRUD,"• The identity representation MUST consist of a printable ASCII string, conformant with the XML Schema anyURI data type (http://www.w3.org/TR/2004/REC-xmlschema-2-20041028/#anyURI).
• The following prefix MUST be used to indicate a Toolkit identity: urn:nhs-uk:identity:
• For a Toolkit identity:
      o The remainder of the address MUST consist of an arbitrarily-long sequence of colon-delimited tokens. The tokens MUST represent a hierarchy with the highest level on the left and the lowest level on the right
      o The first token MUST identify a CFH approved naming authority 
      o The second token MUST be a unique organisation identifier, allocated by that naming authority
      o Subsequent token(s) MAY be locally allocated by the named organisation. That organisation MUST ensure that the uniqueness of the identity is preserved. Note that the precise content and meaning of this local identity information is not prescribed, rather each organisation MUST define their own internal identity namespace – based on their business operations and the entities that need to be identitied. 
• If the address is a non-Toolkit address then the “type” attribute MUST be populated with an OID to indicate the address type. (A Spine smartcard user role profile is another anticipated possibility which MAY be used.)
Example Toolkit Identity: urn:nhs-uk:identity:ods:REC:fbloggs
Note that while the system recording the audit trail may not have direct access to the directory which provides details of the identified user, the initial organisational part of the identity will provide enough detail to enable enquiries to find these details out.

",MW&ACK; CLIENT; HOST& ACK; SMSP HOST; ,ALL,ALL,30
ITK Distribution Envelope Requirements,COR-DEH-05,Distribution Envelope Header–General Requirements, The Distribution Envelope Header “manifest” element MUST be used to contain information about the message payload(s),"1
The “count” element of the manifest MUST record the number of “manifestitem” elements contained in the list","Always applies to systems creating  the distribution envelope.

",Must,SELECT ONE,"EVIDENCE:Execute all tests marked as ""applicable""  after filters have been applied on the Testcases Index  tab. 
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to: 
All Client Applications
Middleware creating an infrastructure acknowledgement i.e. a NACK produced as the result of a routing failure. 
Host Applications that support routable services i.e. Correspondence, Telehealth and HSCI as they create acknowledgements.

NOTE: All validation checks performed by the TKW test that the Manifest Count attribute equals the number of manifests and also that the Payload Count is equal to the Manifest Count.There are also negative test cases defined to ensure the host validation functions as expected (DE_INVMPC).",,"The manifest contains technical information about the message payloads.
(Note that it does NOT contain business metadata such as patient and clinician identities – this business metadata is treated as a payload in its own right).
The “count” element of the manifest MUST record the number of “manifestitem” elements contained in the list

",MW&ACK; CLIENT; HOST& ACK; SMSP HOST; ,ALL,ALL,30
ITK Distribution Envelope Requirements,COR-DEH-06,Distribution Envelope Header–General Requirements,The Distribution Envelope Header “manifestitem” element MUST contain details of a single specific message payload,"1
The id attribute MUST be populated - this MUST contain an identifier that is unique within the message, and which matches the “id” attribute on the corresponding message payload which it describes.
2
The mimetype attribute MUST be populated this MUST describe the mime type of the relevant payload (The valid mime types for use here will be defined on a service-by-service basis).
3
The following attributes are optional Boolean flags which default to “false”. They MAY be populated if required: • metadata – set to “true” if this payload is a block of business metadata • compressed – set to “true” if the payload is compressed. (GZIP compression as per RFC 1952 (eg at http://tools.ietf.org/html/rfc1952) MUST be used) • encrypted – set to “true” if the payload is encrypted • base64 – set to “true” if the payload is base64 encoded","Always applies to systems creating  the distribution envelope.

",Must,SELECT ONE,"EVIDENCE:Execute all tests marked as ""applicable""  after filters have been applied on the Testcases Index  tab. 
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to: 
Client Applications
Middleware creating an infrastructure acknowledgement i.e. a NACK produced as the result of a routing failure. 
Host Applications that support routable services i.e. Correspondence, Telehealth and HSCI as they create acknowledgements.
SMSP Host
",,"The manifestitem contains technical information about one of the message payload(s).
The following attributes MUST be populated
• id – this MUST contain an identifier that is unique within the message, and which matches the “id” attribute on the corresponding message payload which it describes
• mimetype – this MUST describe the mime type of the relevant payload (The valid mime types for use here will be defined on a service-by-service basis)
The following attributes are optional Boolean flags which default to “false”. They MAY be populated if required:
• metadata – set to “true” if this payload is a block of business metadata
• compressed – set to “true” if the payload is compressed. (GZIP compression as per RFC 1952 (eg at http://tools.ietf.org/html/rfc1952) MUST be used)
• encrypted – set to “true” if the payload is encrypted 
• base64 – set to “true” if the payload is base64 encoded

",MW&ACK; CLIENT; HOST& ACK; SMSP HOST; ,ALL,ALL,30
ITK Distribution Envelope Requirements,COR-DEH-07,Distribution Envelope Header–General Requirements,"The “profileid” attribute of the Distribution Envelope Header “manifestitem” MUST be supplied, containing a version identifier for all configurable items within the message if specified for a particular service","NB
For services for which ProfileID is defined, it MUST be populated consistently by a Toolkit Implementation when calling services. If use of the Profile ID is required for a service then details of the Profile ID will be specified separately as part of that service definition.",Always applies to systems creating  the distribution envelope except for Infrastructure Acknowledgement and ADT,Must,SELECT ONE,"EVIDENCE: Execute all tests marked as ""applicable""  after filters have been applied on the Testcases Index  tab. 
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to: 
Client Applications that create messages for anything other than the ADT Domain
Host Applications that support routable services i.e. Correspondence, Telehealth and HSCI as they create Business Acknowledgements which must contain a ProfileID

NOTE: The Service Listings Spreadsheet which is contained in the ITK Accreditation Pack held on TRUD (or Refer Link) contains details of the ProfileID. 

NOTE: Currently all interactions except for ADT and Infrastructure Acks require a ProfileID.",Service Listings,"It is possible to make changes to message definitions that do not necessitate a change to the WSDL or Schema files. For example an externally defined vocabulary may be altered, flexibility in the schema may be exploited to add new optional data items, or subtle changes may be agreed in the semantic usage of identical message content.
For services for which ProfileID is defined, it MUST be populated consistently by a Toolkit Implementation when calling services. 
If use of the Profile ID is required for a service then details of the Profile ID to be used will be specified separately as part of that service definition.
Note that in the case of an intermediary forwarding a call, then the most likely implementation will be to simply pass on the Profile ID provided in the incoming request. However in some circumstances it is possible that the intermediary MAY need to inspect the message Profile ID in order to condition processing.

","CLIENT; HOST& ACK; SMSP HOST;
",ALL EXCEPT ADT,ALL,19
ITK Distribution Envelope Requirements,COR-DEH-10,Distribution Envelope Header–General Requirements,Toolkit Implementations MUST ensure that the Handling Specification section contains an InteractionId,"NB
InteractionIds are used in the ITK Domain Message Specifications (DMS’s) to document/define the expected behaviours, such as is an Infrastructure Ack required.",Always applies to systems creating distribution envelope.,Must,SELECT ONE,"EVIDENCE: Execute all tests marked as ""applicable""  after filters have been applied on the Testcases Index  tab. 
----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: 
","This requirement applies to: 
All Client Applications
Middleware creating an infrastructure acknowledgement i.e. a NACK produced as the result of a routing failure. 
Host Applications that support routable services i.e. Correspondence, Telehealth and HSCI as they create acknowledgements
SMSP Host
",,new at ITK 2.2,MW&ACK; CLIENT; HOST& ACK; SMSP HOST; ,ALL,ALL,30
ITK Distribution Envelope Requirements,COR-DEP-01,Distribution Envelope Header–Payload Requirements,The Distribution Envelope Payloads “count” attribute MUST be populated with the number of Payload elements contained,,Always applies to systems creating distribution envelope.,Must,SELECT ONE,"EVIDENCE: Execute all tests marked as ""applicable""  after filters have been applied on the Testcases Index  tab. 
----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: 
","This requirement applies to: 
All Client Applications
Middleware creating an infrastructure acknowledgement i.e. a NACK produced as the result of a routing failure. 
Host Applications that support routable services i.e. Correspondence, Telehealth and HSCI as they send Acknowledgements and also Host Applications that support ADT Asynchronous bundles as they send Response Messages
SMSP Host

NOTE: All validation checks performed by the TKW test that the @count attribute equals the payloads. Therefore successful validation reports prove implementation. There is also a negative test case defined to ensure the integrity check functions as expected (DE_INVPCT).",,"This is provided for convenience in checking the number of payloads expected, and also as an integrity check.",MW&ACK; CLIENT; HOST& ACK; SMSP HOST; ,ALL,ALL,30
ITK Distribution Envelope Requirements,COR-DEP-02,Distribution Envelope Header–Payload Requirements,Each Payload MUST have an “id” attribute which is unique within the message,"1
While any form of payload id MAY be used, a uuid using upper-case hex prefix with “uuid_” is recommended, because the link between the manifest and payload ids is a case-sensitive string.",Always applies to systems creating distribution envelope.,Must,SELECT ONE,"EVIDENCE: Execute all tests marked as ""applicable""  after filters have been applied on the Testcases Index  tab. 
----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: 
","This requirement applies to: 
All Client Applications
Middleware creating an infrastructure acknowledgement i.e. a NACK produced as the result of a routing failure. 
Host Applications that support routable services i.e. Correspondence, Telehealth and HSCI as they send Acknowledgements and also Host Applications that support ADT Asynchronous bundles as they send Response Messages
SMSP Host

NOTE: The ID must not start with a number,  Prefixing the id with uuid_ is recommended.

NOTE: All validation checks performed by the TKW test that the Manifest Item ID is equal to the Payload ID. Therefore successful validation reports prove implementation. There is also a negative test case defined to ensure the integrity check functions as expected (DE_INVMPI).",,"This enables the payload to be identified, and thus linked to its corresponding manifest description.
","MW&ACK; CLIENT; HOST& ACK; HOST& PATTERN1; SMSP HOST;
",ALL,ALL,29
ITK Distribution Envelope Requirements,COR-DEP-04,,Toolkit Implementations MUST ensure that the Distribution Envelope Error Vocabulary is presented in an ITK Infrastructure Acknowledgement.,"NB
An Infrastructure Acknowledgement message is used to communicate a Distribution Envelope processing issue.",Always applies to systems creating distribution envelope. ITK 2.2 Only.,Must,SELECT ONE,"EVIDENCE: Execute all tests marked as ""applicable""  after filters have been applied on the Testcases Index  tab. 
----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: 
","This requirement applies to: 
All Client Applications
Middleware creating an infrastructure acknowledgement i.e. a NACK produced as the result of a routing failure. 
Host Applications that support routable services i.e. Correspondence, Telehealth and HSCI as they create acknowledgements.
SMSP Host

NOTE: The requirement can be marked as Compliant whether the filename is used or not.",,NEW FOR ITK 2.2,"MW&ACK; CLIENT; HOST& ACK; HOST& PATTERN1; SMSP HOST;
",ALL,ALL,29
"ITK Client, Host and ITK Middleware Requirements",COR-REL-02,Reliability,Toolkit Implementations MAY retry if a transport response is not received,"NB
The lack of a transport-level response within any expected timeout period is an indication that the transport-level transmission may have failed. In these circumstances the sending Toolkit Implementation may retry if the underlying transport meaningfully allows it.",Always applies to systems that send messages,May,SELECT ONE,"STATEMENT: A statement of compliance to simply confirm or otherwise that the requirement is met.

EVIDENCE: Execute ER_INVTIM from the Testcases Detailed tab.
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: 
","This requirement applies to:
All Client Applications 
Host Applications that support routable services i.e. Correspondence, Telehealth and HSCI as they send Acknowledgements and also Host Applications that support ADT Asynchronous bundles as they send Response Messages
All Middleware

NOTE: If this requirement is not implemented (not mandatory as this is a MAY requirement), then set the Compliance Status to ""Not Applicable"" and confirm by statement in Column I",,The lack of a transport-level response within any expected timeout period is an indication that the transport-level transmission may have failed. In these circumstances the sending Toolkit Implementation MAY retry if the underlying transport meaningfully allows it.,"MW; CLIENT; HOST&ACK; HOST& PATTERN1;

",ALL,ALL,35
"ITK Client, Host and ITK Middleware Requirements",COR-REL-03,Reliability,Toolkit Implementations MUST retain responsibility for processing until a request completes,"NB
Specifically, any response returned from the initial part of the asynchronous invocation does NOT indicate a transfer of responsibility. It is only a transport acknowledgement, and it does NOT imply that the message has necessarily been persisted, nor does it indicate a transfer of responsibility, nor promise that subsequent application processing will be completed.",Applies to systems that send messages,Must,SELECT ONE,"STATEMENT: A statement of compliance  simply confirming that the requirement is met.
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to:
All Client Applications 
Host Applications that support routable services i.e. Correspondence, Telehealth and HSCI as they send Acknowledgements and also Host Applications that support ADT Asynchronous bundles as they send Response Messages
All Middleware 

NOTE: For synchronous interactions, the system must maintain responsibility until the synchronous response is received.
For asynchronous interactions, the system must maintain responsibility until the asynchronous response is received. Note that the receipt of the HTTP 202 synchronous response does not indicate the response is complete.
  
NOTE: If the responses are not received, the system is responsible for taking appropriate action e.g. logging a failure, writing to console etc.",,"As discussed in COR-REL-01, it is only the receipt of a response, a fault, or completion of a request that confirms that all relevant processing is complete. The Toolkit Implementation MUST retain responsibility for processing until a request is complete.
Specifically, any response returned  from the initial part of the asynchronous invocation does NOT indicate a transfer of responsibility. It is only a transport acknowledgement, and it does NOT imply that the message has necessarily been persisted, nor does it indicate a transfer of responsibility, nor promise that subsequent application processing will be completed. 
","MW; CLIENT; HOST&ACK; HOST& PATTERN1;

",ALL,ALL,35
"ITK Client, Host and ITK Middleware Requirements",COR-REL-05,Reliability,"Toolkit Implementations MUST provide details of how services handle, and recover from, transport failures during execution","A service which does not complete before the invocation times out, may leave the requestor uncertain of the state of the request and its business data. Toolkit implementations must provide information as to how such cases are safely handled.",Always applies to systems that send messages,Must,SELECT ONE,"STATEMENT: A statement of compliance simply explaining how service requests that fail to complete before invocation timeout are safely handled. 

EVIDENCE: Execute ER_INVTIM from the Testcases Detailed tab.
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: 
","This requirement applies to:
All Client Applications 
Host Applications that support routable services i.e. Correspondence, Telehealth and HSCI as they send Acknowledgements and also Host Applications that support ADT Asynchronous bundles as they send Response Messages
All Middleware 

NOTE: This may involve the commiting of all messages to a database, fault alerting, use of the NACK infrastructure responses for Middleware, error logging, etc. ",,"A service which does not complete before the invocation times out, may leave the requestor uncertain of the state of the request and its business data. Toolkit implementations MUST provide information as to how such cases are safely handled.","MW; CLIENT; HOST&ACK; HOST& PATTERN1;

",ALL,ALL,35
"ITK Client, Host and ITK Middleware Requirements",IFC-LOG-01,Supporting Infrastructure - Logging,"Toolkit Implementations MUST support configurable
diagnostic logging","1
Toolkit implementations MUST provide diagnostic logging of messages and events.
2
Toolkit implementations MUST provide a real time configurable control of logging, to allow the logging to be switch on during testing or troubleshooting.
3
Toolkit implementations SHOULD provide the equivalent of configurable logging levels including but not limited to: Errors only – logs only errors - recording at least the message ids, message type, and timestamp in each case. This might typically be used in a mature and high volume production environment. Informational – logs message id, message type, timestamp, and limited additional information about each message. This might typically be used for troubleshooting in a production environment Full diagnostic – logs message id, message type, timestamp, plus full details of each message. This might typically be used in test environment, or in carefully controlled circumstances for troubleshooting in a production environment.
4
Toolkit implementations MUST record the Tracking ID appearing in the Distribution Envelope, within the logs.",Always applies,Must,SELECT ONE,"STATEMENT: A statement of compliance confirming that the product supports configurable diagnostic logging. The statement should state which of the logging levels referred to in the requirement are supported and confirm that the Tracking ID is included in the log for all levels.

EVIDENCE:  Provide a sample log file showing Tracking ID for any of the tests executed.
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: 
","This requirement applies to:
All Client Applications 
All Host Applications
All Middleware
SMSP Host

NOTE: The sample log file provided can be from any of the logging levels. It should show that the log contains the Tracking ID of the message that has been processed for the test that has been executed. Any test from the Testcases Detailed is acceptable.",,"This must allow logging to be switched on for testing or troubleshooting, but switched off to enhance performance in the production environment.
There SHOULD be at least the equivalent of the following configurable logging levels:
  • Errors only – logs only errors - recording at least the message ids, message type,  and timestamp in each case. This might typically be used in a mature and high volume production environment
  • Informational – logs message id, message type, timestamp, and limited additional information about each message. This might typically be used for troubleshooting in a production environment 
  • Full diagnostic – logs message id, message type, timestamp, plus full details of each message. This might typically be used in test environment, or in carefully controlled circumstances for troubleshooting in a production environment.
Messages with a Distribution Envelope (see [2]) will also provide a Tracking ID, and this MUST also be recorded in the logs for all logging levels
Note: An exception MAY be granted for “black box” medical devices which only expose a communication interface, and are genuinely not capable of providing such logging. Any such exception must however be requested and considered on a case-by-case basis.
",ALL,ALL,ALL,1
"ITK Client, Host and ITK Middleware Requirements",IFC-LOG-02,Supporting Infrastructure - Logging,Toolkit Implementations MUST ensure Patient Identifiable data is adequately protected in log files and administrative tools,,Always applies,Must,SELECT ONE,"STATEMENT: A statement of compliance describing how Patient Identifiable data is protected at all times.
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to:
All Client Applications 
All Host Applications
All Middleware
SMSP Host

NOTE: For example statements, please see requirement description.",,"It is essential that log files and administrative tools do not become a vulnerability whereby patient identifiable data is exposed.
Possible implementation strategies might include:
  • Securing or encrypting log files
  • Encrypting sensitive message fields within the application processing
  • Disallowing logging / viewing of sensitive data fields in a production environment
This list is not intended to be prescriptive or exhaustive, however the requirement is that Patient Identifiable data must be adequately protected at all times.
",ALL,ALL,ALL,1
"ITK Client, Host and ITK Middleware Requirements",IFC-ALT-01,Supporting Infrastructure - Alerting,Toolkit Implementations SHOULD allow technical alerts to be configured,"1
Toolkit implementations SHOULD allow alerts to be generated based on but not limited to sizes, message throughput, Error Store and throttling backlog.",Always applies,Should,SELECT ONE,"STATEMENT: A statement of compliance describing how this requirement is satisfied. 
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to:
All Client Applications 
All Host Applications
All Middleware
SMSP Host

NOTE: For example statements, please see requirement description.",,"It should be possible to configure alerts to proactively inform human administrators of error conditions. 
Examples include thresholds based on queue sizes, message throughput, or throttling backlog. Monitoring of the Error Store is particularly important.
",ALL,ALL,ALL,1
"ITK Client, Host and ITK Middleware Requirements",IFC-ALT-02,Supporting Infrastructure - Alerting,Toolkit Implementations SHOULD support SNMP alerting,"1
Toolkit implementations SHOULD provide a SNMP alerting mechanism to Service Monitoring systems.
2
Toolkit implementations SHOULD provide a SNMP interface for interrogation of counters and manipulation of configuration.",Always applies,Should,SELECT ONE,"STATEMENT: A statement of compliance describing how this requirement is satisfied. 
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to:
All Client Applications 
All Host Applications
All Middleware
SMSP Host

NOTE: If SNMP Alerting is not supported, please provide details of the alternative alerting solution in Column I and set the Compliance Status to Non Compliant.",,"SNMP alerting is a popular standard supported by most 3rd party Operations Consoles.
SNMP configuration and counters SHOULD also be supported
",ALL,ALL,ALL,1
"ITK Client, Host and ITK Middleware Requirements",IFC-TIM-01,Supporting Infrastructure - Time,The Toolkit Implementation system clock MUST be synchronised with a consistent time source to within 250 milliseconds,"1
Toolkit implementations MUST use a NTP service that is consistent to within 250 milliseconds across the estate.
2
Toolkit implementations SHOULD use a NTP service that is at least a Stratum 3 time source.
3
Toolkit implementations SHOULD use a NTP service that returns Greenwich Mean Time (GMT), an equivalent of Coordinated Universal Time (UTC).",Always applies,Must,SELECT ONE,"STATEMENT: A statement of compliance describing how this requirement is satisfied and confirming that the system clock is synchronised with a time source common to all systems connected to that Toolkit instance. 
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to:
All Client Applications 
All Host Applications
All Middleware
SMSP Host

NOTE: The statement can confirm that the time source is taken from the ser ver time source at the deployed sites e.g. the Trust time source.",,"This enables meaningful comparison and sorting of messages based on timestamps.
The system clock MUST be synchronised with a time source common to all systems connected to that Toolkit instance.
To maximise options for wider future connectivity, this time source SHOULD be a Stratum 3 time source (or better) that returns Greenwich Mean Time (GMT), an equivalent of Coordinated Universal Time (UTC).
",ALL,ALL,ALL,1
"ITK Client, Host and ITK Middleware Requirements",IFC-TIM-02,Supporting Infrastructure - Time,All timestamps generated by Toolkit Implementations MUST comply with issued guidance on time zones,"1
Toolkit implementations and their messages MUST comply with “NPFIT-FNT-TO-SCG-0005.14 – Clarification on Time Zone”",Applies to systems that create Timestamps in Messages,Must,SELECT ONE,"STATEMENT: A statement of compliance confirming  that the document referenced in the requirement has been read and understood and that the requirements within it will be complied with in all deployments.
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to:
All Client Applications 
Host Applications that support routable services i.e. Correspondence, Telehealth and HSCI because they will create Acknowledgements that contain the Timestamp
All Middleware 
SMSP Host

NOTE: The document referred to in the requirement is available on TRUD but can also be accessed from the link provided here.

NOTE: This requirement is referring to the format of the timestamp within the SOAP Header that is created only.
",Timezone Document,"See “NPFIT-FNT-TO-SCG-0005.14 – Clarification on Time Zone” for details which MUST be complied with.
NB: References made by the guidance document to the “MIM”, except those in Section 5, also apply to Toolkit messages.
","MW; CLIENT; HOST&ACK; SMSP HOST;
",ALL,ALL,36
"ITK Client, Host and ITK Middleware Requirements",IFC-TIM-03,Supporting Infrastructure - Time,"All timestamps displayed by Toolkit Implementations
MUST comply with issued guidance on time zones",,Always applies,Must,SELECT ONE,"STATEMENT: A statement of compliance confirming  that the document referenced in the requirement has been read and understood and that the requirements within it will be complied with in all deployments.
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to:
All Client Applications 
All Host Applications 
All Middleware 
SMSP Host

NOTE: This requirement applies to all applications where a timestamp is displayed i.e. not in the message. Examples of this could be display on an input  screen, output screen, on a report, on a letter etc. Exceptions to this may be technical documents where the timestamp is displayed e.g. log files

NOTE: The document referred to in the requirement is available on TRUD but can also be accessed from the link provided here.

NOTE: Refer to Section 4.2 of the document which states ""To avoid confusion and clinical errors the display of time must be clearly displayed in local time suitable for the consuming user’s perspective, which may include accounting for BST as well as translating UTC to local time.""


NOTE: If the system does not display any timestamps, then set the Compliance Status to Not Applicable and provide a statement in Column I confirming this.",Timezone Document,"See “NPFIT-FNT-TO-SCG-0005.14 – Clarification on Time Zone” for details which MUST be complied with.
In summary the document says that timestamps must be displayed in local time. However please see the referenced document for full details.",ALL,ALL,ALL,1
"ITK Client, Host and ITK Middleware Requirements",IFC-NFR-01,Supporting Infrastructure - Non-functional,Toolkit Implementations MUST support a configurable maximum message size,"1
Toolkit implementations MUST, in order to support interoperability across the ITK estate, support and honour the required maximum message size that is provided for each type of message type
2
Toolkit implementations MUST honour a configurable maximum message size. This size applies to the entirety of the message – i.e. including and distribution envelope and other transport wrappers, and after any compression and base64 encoding is applied.
3
Toolkit implementations MUST accept incoming messages that are smaller than or equal to the configurable maximum message size.
4
Toolkit implementations MAY reject incoming messages if they are larger than this required maximum size.
ITK Client, Host and ITK Middleware Requirements V1.0 30/04/2014
Page 18 of 36 Copyright © 2014 Health and Social Care Information Centre
5
Toolkit implementations SHOULD NOT generate messages that are larger than this required maximum size.
6
Toolkit implementations MUST take responsibility for ensuring that any endpoint sent a larger message than the required maximum is able to handle it (e.g. by local agreement).",Always applies,Must,SELECT ONE,"STATEMENT: A statement of compliance detailing how the requirement is met.
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to:
All Client Applications 
All Host Applications 
All Middleware 
SMSP Host

NOTE: Statement for Client Applications and Host Applications implementing Pattern 1 interactions (including SMSP Host):-
provide confirmation that when you create a message it cannot be greater than a configurable maximum defined size 



",,"Toolkit implementations MUST honour a configurable maximum message size. This size applies to the entirety of the message – ie including and distribution envelope and other transport wrappers, and after any compression and base64 encoding is applied.
In order to support interoperability across the ITK estate, a required maximum message size is provided for each type of message (see Toolkit Service Listing spreadsheet).
- Toolkit implementations MUST accept incoming messages that are smaller than or equal to this required maximum size
- Toolkit implementations MAY reject incoming messages if they are larger than this required maximum size
- Toolkit implementations SHOULD NOT generate messages that are larger than this required maximum size. However if they do then they MUST take responsibility for ensuring that any endpoint sent a larger message is able to handle it (eg by local agreement)

",ALL,ALL,ALL,1
"ITK Client, Host and ITK Middleware Requirements",IFC-SEC-01,Supporting Infrastructure -Infrastructure Security,Toolkit Implementations MUST comply with standard HSCIC guidance for audit,"NB
Toolkit implementations MUST provide audit and alert in compliance with the CFH IG document “IG Audit & Alerts Gold Standard” document ref: NPFIT-FNT-TO-IG-PRJMGT-0093.05",Always applies,Must,SELECT ONE,"STATEMENT : A  statement of compliance confirming  that the document referenced in the requirement has been read and understood and that the requirements within it will be complied with in all deployments.

EVIDENCE:  Provide a sample Audit log file for any of the tests executed.
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to:
All Client Applications 
All Host Applications 
All Middleware 
SMSP Host

NOTE: The document referred to in the requirement is available on TRUD but can also be accessed from the link provided here.

NOTE: The sample log file provided for evidence can be from any test executed from the Testcases Detailed tab.",Audit and Alerts Document,The Toolkit implementation MUST provide audit  and alert in compliance with the CFH IG document “IG Audit & Alerts Gold Standard” document ref: NPFIT-FNT-TO-IG-PRJMGT-0093.05,ALL,ALL,ALL,1
"ITK Client, Host and ITK Middleware Requirements",IFC-SEC-02,Supporting Infrastructure -Infrastructure Security,Toolkit Implementations  MUST comply with standard HSCIC guidance for infrastructure and data security,"1
Based on the findings of a risk assessment the Toolkit Implementation MAY have to support disk encryption unless the risk assessment finds otherwise e.g. the Toolkit Implementation is not going to hold PID or is located in a secure data centre environment.
2
Encryption, if required SHOULD meet with the Information Security Teams Approved Cryptographic Algorithms
3
Other data security standards that MUST be adhered to are Disposal and Destruction of Sensitive Data
4
Other data security standards that MUST be adhered to are Secure Use of the N3 Network
NB
Information Governance standards for systems for NHS and partner organisations are made available at http://systems.hscic.gov.uk/infogov",Always applies,Must,SELECT ONE,"STATEMENT: A statement of compliance to confirm: 
(a) the documents have been read and understood, that the risk assessment has been performed, and that any of the subsequent requirements will be  complied with in all deployments. 
(b) The two data standards 'Disposal and Destruction of Sensitive Data' and 'Secure Use of the N3 Network' have been read and understoood, and will be complied with in all deployments.
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: 
","This requirement applies to:
All Client Applications 
All Host Applications 
All Middleware 
SMSP Host

NOTE: The document referred to in the requirement is available on TRUD but can also be accessed from the link provided here.",Disposal and Destruction of Sensitive Data,"The Information Security Teams General Principles for Securing Information Systems provides introductory guidance on general principles for securing information systems. The document provides high level guidance on this topic and is suitable for use during the planning, development, testing and rollout of new information systems
http://nww.connectingforhealth.nhs.uk/infrasec/gpg/gensec.pdf
 
Based on the findings of a risk assessment the Toolkit Implementation MAY have to support disk encryption unless the risk assessment finds otherwise e.g. the Toolkit Implementation is not ever going to hold PID or is located in a secure data centre environment. Encryption, if required should meet with the Information Security Teams Approved Cryptographic Algorithms GPG http://nww.connectingforhealth.nhs.uk/infrasec/gpg/acs.pdf. 

Other data security standards that MUST be adhered to are
Disposal and Destruction of Sensitive Data http://nww.connectingforhealth.nhs.uk/infrasec/gpg/disposal.pdf
Secure Use of the N3 Network http://nww.connectingforhealth.nhs.uk/infrasec/gpg/securen3.pdf
",ALL,ALL,ALL,1
"ITK Client, Host and ITK Middleware Requirements",IFA-REL-02,Supporting Infrastructure -Application Specific,"Toolkit Applications receiving error notifications MUST provide layered error handling to cover End-User, Automated, and Administrative error processing",,Applies to Client and Host applications that send messages.,Must,SELECT ONE,"STATEMENT: A statement of compliance explaining how the three categories are implemented when receiving an error message in response to a sent message.

EVIDENCE:  Provide a screenshot showing an example to supplement the statement.
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: 

","This requirement applies to:
All Client Applications 
All Host Applications  that support routable services i.e. Correspondence, Telehealth and HSCI as they send Acknowledgements 
SMSP Host

NOTE: Statement should  explain how the three categories are implemented when receiving an error message in response to a sent message. For example how is the end user informed, how is an adminstrator informed etc.


",,"If an application consumes Toolkit services then support MUST be provided for three categories of error notification usage, specifically:
  • End-User – Formulating, where relevant, a notification to a human end-user (such as a clinician)  allowing them to understand what has happened and take safe and appropriate follow up action
  • Automated processing – Automated handling (eg based on error codes) to allow the calling application to interpret the problem and initiate appropriate recovery or error handling actions
  • Administrative user - technical logging and alerts sufficient to allow operations staff to diagnose, fix, and prevent further occurrences of the problem
This must also include graceful handling for unrecognised errors
","CLIENT; HOST& ACK; SMSP HOST;
",ALL,ALL,19
"ITK Client, Host and ITK Middleware Requirements",IFA-SEC-01,Supporting Infrastructure -Application Specific,"Service Client Applications MUST take responsibility for end-user authentication, authorisation and audit","1
The ITK Trust Operating Model document set provides more information about the process for determining what controls are required in a given situation.
In relation to Auditing, Toolkit Implementations - MUST maintain a log of auditable events including connections and requests for information both when successful and otherwise.
Such audit logs SHOULD record origin and other requestor identity, operation, and details such as patient identifier where available.
NB
Note: The Trust Operating Model documentation set provides more information about this process for determining what controls are required in a given situation.",Applies to Client Applications,Must,SELECT ONE,"STATEMENT: Statement should confirm that  application is responsible for authentication, authorisation and audit of the end user.
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to:
All Client Applications 

NOTE: This requirement relates to end users, if the application has contact with end users, you should describe the authentication and authorisation process i.e. is a Smart Card required, password protection, RBAC in place etc. If the application does not have contact with end users per se, you should describe how the input data is verified and known to be reliable e.g. the data comes directly from the PAS or other trusted source.",,"The Service Client application has the contact with the end-user, and must take responsibility for user authentication, authorisation and audit.

This is because the end-user’s identity is not necessarily visible to the Toolkit. Rather it may see only the identity of the trusted Service Client application. 

The ability of a Service Client application to utilise specific Toolkit services will thus depend on the strength of the application’s authentication and authorisation methods. The Trust Operating Model document set provides more information about this process for determining what controls are required in a given situation.
",CLIENT,ALL,ALL,8
"ITK Client, Host and ITK Middleware Requirements",IFA-SEC-02,Supporting Infrastructure -Application Specific,For messages where a Distribution Envelope Audit Identity is provided then Toolkit Applications MUST record this in their audit logs,,Applies to Client and Host Applications.,Must,SELECT ONE,"EVIDENCE: Evidenced with audit logs, evidence should be provided to show the audit entries (containing Audit ID) for one of the tests in the submission.

-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to:
All Client Applications 
All Host Applications 
SMSP Host

NOTE: Client Applications must log the Audit Identity of the sent message and also log the Audit Identity of any received Acknowledgement messages where applicable. 
Host Applications must log the Audit Identity of any received messages including Acknowledgement Messages where applicable.",,If an Audit Identity is provided in the Distribution Envelope then all Toolkit Applications MUST record the Audit Identity in their audit logs,CLIENT; HOST; SMSP HOST; ,ALL,ALL,23
"ITK Client, Host and ITK Middleware Requirements",MOD-ASQ-02,Additional Modules - Sequencing,"Client Applications SHOULD support insequence invocation of Toolkit services, where this is required","1
Service Client Application SHOULD be able to preserve a technical FIFO sequence of events when placing outbound calls to the Toolkit.
2
The implication of this FIFO processing is that the Service Client Application MUST await a successful SOAP response from one outbound call before placing the next one.
3
Where it is provided then the use of FIFO processing SHOULD be configurable on/off to allow further implementation flexibility.
Therefore this behaviour SHOULD only be provided by a Service Client Application for groups of Toolkit invocations where the sequencing is known to be significant.",Applies to Client Applications,Should,SELECT ONE,"STATEMENT:  Statement should explain the significance of the sequence of events. If the sequence is significant it should further explain how the product is configured to meet this requirement.
---------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to:
All Client Applications

NOTE: Scenario specific - if the application does NOT support this feature, then please give reasons based on the messages being implemented, why the sequence is not important. If this is the case then set the Compliance Status to Not Applicable.
Key point is that the application MUST NOT rely on some other part of the infrastructure to get messages into the right order for it.
",,"It may be that events occur within a Web Service Client Application in a sequence which that
application knows to be significant. For example, a stream of patient events including, for
example, admittance, ward transfers, discharge etc. In this case the Web Service Client
Application SHOULD be able to preserve a technical FIFO sequence of these events when
placing outbound calls to the Toolkit.
Note that this is a purely technical feature involving the in-sequence processing of Toolkit
invocations. It does NOT imply any knowledge of the message content, nor any business
logic with knowledge of the context. For example, this FIFO invocation processing would keep
all invocations of a given set of Toolkit services in order, regardless of the patient they refer
to.
This feature potentially simplifies downstream processing – avoiding the need for business resequencing
and error handling later by ensuring that invocations are never “jumbled up” in the
first place.
The implication of this FIFO processing is that the Web Service Client Application MUST
await a successful SOAP response from one outbound call before placing the next one.
Note that while FIFO processing is a useful behaviour, it has tradeoffs and is therefore not
always desirable. For example message sequencing is not always relevant, and where this is
the case then parallel processing can be used to increase throughput and scalability. Even if
sequencing is relevant, any approach based on FIFO processing must be carefully
considered on a use-case by use-case basis. It is important to be certain that FIFO
processing can scale to the required volumetrics for the use-case. Where this is not the case
then other approaches - such as business-sequencing in the end recipient application (as
described in MOD-ASQ-01) - must be used.
Therefore this behaviour SHOULD only be provided by a Web Service Client Application for
groups of Toolkit invocations where the sequencing is known to be significant. Where it is
provided then the use of FIFO processing SHOULD be configurable on/off to allow further
implementation flexibility.",CLIENT,ALL,ALL,8
"ITK Client, Host and ITK Middleware Requirements",MOD-AIG-01,Additional Modules - Information Governance - Application Location Shielding,"Toolkit Applications MUST provide capabilities to shield
patient location details","NB
This feature might be used, for example, to protect the location details of an abused spouse. It is intended to offer a reasonable but limited level of protection, while still allowing essential care processes to continue. For higher risk threats then alternative mechanisms are available and should be used - for example, a complete change of identity. The exact details of what constitutes “adequate” local shielding functionality cannot be prescribed here. Typically a shielding capability will involve blanking / obscuring / protecting location-related fields including: • Addresses • Telephone numbers • Email addresses • Next of kin details • GP details Note that this is not necessarily an exhaustive list. Typically a shielding capability will involve blanking / obscuring / protecting location-related fields including: • Addresses • Telephone numbers • Email addresses • Next of kin details • GP details Note that this is not necessarily an exhaustive list. Consideration should also be given protecting / deleting historical location details. Exactly what is appropriate in any given scenario is a local decision, based on weighing up the breadth of access to the application vs the benefits of enabling care processes to use the data vs the risks of exposure. Further guidance on making these local risk-management decisions is provided in the Toolkit Trust Operating Model.",Always applies to Client and Host Applications,Must,SELECT ONE,"STATEMENT:  Statement should briefly explain the location shielding capabilities of the application.

-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to:
All Client Applications
All Host Applications

NOTE: This is a generic MUST requirement that relates to the ITK Application, and talks in general terms about location shielding. The supplier just needs to briefly explain their location shielding capabilities.
It is local custom and practice governing whether a data source, or a subset of data from that source, is shielded and the mechanism used for that shielding.
For example, it could be governed by a locally held list of patients, via RBAC or via business practice.
What is required is a statement demonstrating that consideration has been given to the shielding of patient location details.

Another example might be:- While this requirement is not currently implemented, the product is highly configurable and this feature could be added quickly and at no extra cost. An outline design would be:
i) a 'shield patient location data' flag would be added to the product patient record
ii) if this flag is set, then product would display an alternative patient demographic data screen to the end user which did not display the patient-location fields

NOTE - The shielding requirements are not applicable to SMSPs as the requirments talk about shielding at a local level. If details are s-flag shielded on PDS they will not be returned from PDS.",,"Toolkit Applications MUST offer the ability to “shield” patient location details to protect the patient. This feature might be used, for example, to protect the location details of an abused spouse. It is intended to offer a reasonable but limited level of protection, while still allowing essential care processes to continue. For higher risk threats then alternative mechanisms are available and should be used - for example, a complete change of identity.
The exact details of what constitutes “adequate” local shielding functionality cannot be prescribed here. It could involve various strategies ranging from simple discarding of incoming messages relating to shielded patients, through to more sophisticated Role Based Access Controls (RBAC) controlling the visibility of individual fields.
Typically a shielding capability will involve blanking / obscuring / protecting location-related fields including:
  • Addresses
  • Telephone numbers
  • Email addresses
  • Next of kin details
  • GP details
Note that this is not necessarily an exhaustive list. 
Consideration SHOULD also be given protecting / deleting historical location details.
Exactly what is appropriate in any given scenario is a local decision, based on weighing up the breadth of access to the application vs the benefits of enabling care processes to use the data vs the risks of exposure. Further guidance on making these local risk-management decisions is provided in the Toolkit Operating Model.
",CLIENT; HOST;,ALL,ALL,22
"ITK Client, Host and ITK Middleware Requirements",MOD-AIG-02,Additional Modules - Information Governance - Application Location Shielding,"Toolkit Applications MUST pass on knowledge of any
shielding of patient location details","1
. Where a “shielding” feature as-per MOD-AIG-01 is offered then the application MUST pass on the value of this patient location “shielding” status in any Toolkit messages to other systems.","Applies to  Applications that send demographic data 

",Must,SELECT ONE,"STATEMENT: Statement should detail how the requirement is met.
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to:
Client Applications that send demographic data 
Host Applications that provide response messages containg demographic data 

Note: Applications that create ADT messagescontaining demographic data must include the ‘shielding’ status if known  within the Z segments (ZU1 - UK Additional Data (HL7 ref A.4.3.1)). See ITK HL7v2 ADT Message Specification Reference Tables (NPFIT-ELIBR-AREL-DST-0376) section 3.131 User Table ZU057 - Location Hiding. This document can be found in the HL7V2 ADT Pack held on TRUD - in the Tables Tab.

For non ADT messages as there is no shielding status included in the message then other options should be considered e.g. 

1. ‘If we receive shielded details these will be passed on’
2. ‘We will not receive or pass on shielded details’
3. ‘We pass on all details but the recipient will know locally which should not be displayed’.
4. ‘We will support reasonable requirements in respect of receiving systems that require shielded patient identifiers within outbound messaging. This could include, for example, placing such identifiers within specified location fields’
5. 'Prior to deployment a review of requirements to shield patient location data within the receiving clinical setting must be completed. Where a requirement to shield location data is identified outgoing messages will be amended before transmission as necessary to support the shielding mechanisms used by the recipient.'
6. 'While this requirement is not currently implemented, the product has full control over patient data at the point of message creation and this feature could be added quickly and at no extra cost. An outline design would be:
i) a 'shield patient location data' flag would be added to the product patient record
ii) this field would be checked at message creation time, and if set, the corresponding message element would be set appropriately'",,"Where a “shielding” feature as-per MOD-AIG-01 is offered then the application MUST pass on the value of this patient location “shielding” status in any Toolkit messages to other systems. 
By including the value of the patient “shielding” status, an application allows downstream processing (by both the Toolkit Middleware and other Toolkit applications) to provide appropriate handling of these “shielded” location details
",CLIENT; HOST& PATTERN1;,ALL,ALL,21
"ITK Client, Host and ITK Middleware Requirements",MOD-AIG-04,Additional Modules - Information Governance - Application Location Shielding,Toolkit Applications MAY allow shielded location details to leave the application,"NB
In general it is not necessary for a sending application to “blank out” location details for shielded patients before sending externally, e.g. to the Toolkit Middleware. This is because MOD-AIG-01 mandates that receiving applications will have the ability to appropriately protect shielded location details. This approach provides maximum flexibility for cases where a receiving application may need to make use of the demographic data for valid local processing. Despite the above, some Toolkit Applications may choose to use a number of means to provide additional “shielding” protection for location details before passing them via an interface.
For example: • Blanking fields • Writing a placeholder value in fields (e.g. “NOT AVAILABLE”) • Capturing pseudo values – for example the address of a friend who can forward post These measures do provide further “shielding” protection of the location details. However it should be noted that there is a disadvantage as this location information may in some circumstances be needed for valid processing in other local systems.","Applies to Applications that send demographic data

",May,SELECT ONE,"STATEMENT: Statement should detail how the requirement is met.
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to:
Client Applications that send demographic data 
Host Applications that create response messages containg demographic data e.g. ADT Async

NOTE: If this requirement is implemented please provide details in the statement of what means are used to provide additional shielding before passing on the details. If this requirement is not implemented the Compliance Status should be set to Not Applicable.

",,"In general it is not necessary for a sending application to “blank out” location details for shielded patients before sending externally, eg to the Toolkit Middleware. This is because MOD-AIG-01 mandates that receiving applications will have the ability to appropriately protect shielded location details. This approach provides maximum flexibility for cases where a receiving application may need to make use of the demographic data for valid local processing.

Despite the above, some Toolkit Applications MAY choose to use a number of means to provide additional “shielding” protection for location details before passing them via an interface. For example:
  • Blanking fields
  • Writing a placeholder value in fields (eg “NOT AVAILABLE”)
  • Capturing pseudo values – for example the address of a friend who can forward post
These measures do provide further “shielding” protection of the location details. However it should be noted that there is a disadvantage as this location information may in some circumstances be needed for valid processing in other local systems.
",CLIENT; HOST& PATTERN1;,ALL,ALL,21
"ITK Client, Host and ITK Middleware Requirements",MOD-AIG-05,Additional Modules - Information Governance - Application Location Shielding,Toolkit Applications MAY adjust processing flow on receipt of notification that a patient has a shielding setting,"1
An application MAY wish to adjust its processing in other ways when receiving data for “shielded” patients (e.g. omitting screens relating to location which may no longer be relevant / meaningful)","Applies to Applications that receive demographic data

",May,SELECT ONE,"STATEMENT: Statement should detail how the requirement is met.
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to:
Client Applications that receive response messages containing demographic data e.g. ADT Async, PDS Mini Services
Host Applications that receive messages containg demographic data 

NOTE: If this requirement is implemented please provide details in the statement of how processing is adjusted when shielding information is received. If this requirement is not implemented the Compliance Status should be set to Not Applicable.",,An application MAY wish to adjust its processing in other ways when receiving data for “shielded” patients (eg omitting screens relating to location which may no longer be relevant / meaningful),CLIENT&PATTERN1; CLIENT&PDS; HOST;,ALL,ALL,17
"ITK Client, Host and ITK Middleware Requirements",MOD-AIG-06,Additional Modules - Information Governance - Sealing,Toolkit Applications MUST NOT allow sealed data to leave the application,"1
Many applications have an ability to flag certain items of clinical data as “sealed” or “sealed and locked”. This data MUST NOT be allowed to leave the application in any Toolkit messages. Note: Based on current IG policy, a dispensation on compliance with this requirement MAY be granted where it can be shown that BOTH (i) the patient has explicitly agreed to the sharing of sealed date AND (ii) the receiving application also has appropriate sealing mechanisms in place. This dispensation must be explicitly applied for on a case-by-case basis.","Applies to Applications that send  clinical data

",Must,SELECT ONE,"STATEMENT:  Statement should detail how the requirement is met.
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to:
Client Applications that send clinical data 
Host Applications that provide response messages containg clinical data e.g. ADT Async 

Options to be considered e.g. 

1. ‘We will not receive or pass on sealed data
2. 'Sealed patient information will never be passed to our application and this will be agreed locally prior to each deployment'
3. 'For each deployment it will be agreed locally that a shielding flag will be set, the flag will be checked and if set no data will be passed on.",,"Many applications have an ability to flag certain items of clinical data as “sealed” or “sealed and locked”.
This data MUST NOT be allowed to leave the application in any Toolkit messages.
Note: Based on current IG policy, a dispensation on compliance with this requirement MAY be granted where it can be shown that BOTH (i) the patient has explicitly agreed to the sharing of sealed date AND (ii) the receiving application also has appropriate sealing mechanisms in place. This dispensation must be explicitly applied for on a case-by-case basis.
",CLIENT; HOST& PATTERN1;,ALL,ALL,21
"ITK Client, Host and ITK Middleware Requirements",MOD-AIG-08,Additional Modules - Information Governance -Application Cross Organisational Data Sharing,Toolkit Applications MUST ensure that the patient’s consent preferences are honoured when sharing Detailed Care Record information across organisational boundaries,"NB
There are several means by which Toolkit Applications may be involved in sharing Detailed Care Record (DCR) information across organisational boundaries. For example: 
• An application belonging to one organisation may receive data via a Toolkit interface from an application belonging to a different organisation
• An application may present a user interface (e.g. web portal) that is accessible to users from other organisations 
• An application may have other (non-Toolkit) integrations that exchange data with applications belonging to other organisations
In all cases a Toolkit application must ensure that, prior to allowing sharing of Detailed Care Record information across organisational boundaries, the patient’s consent preferences are checked and the results of this check are recorded. If the patient expresses Dissent then the DCR information sharing must be blocked.
The preferred approach to performing this check is that an application should make use of the patient’s DCR Consent preferences as recorded by the PDS Consent flag. This is intended to be a National setting that is honoured by all applications.
Alternatively, if access to the PDS Consent flag is not available, the application must offer an alternative approach. For example this might involve asking the patient directly, and recording their response. 
Note: Options for accessing the PDS Consent Flag include: 
1. Direct access to PDS by a PDS Compliant application 
2. Using a DCR consent flag contained in an incoming Toolkit message (subject to this being freshly populated, as described below) In all cases knowledge of the patient’s NHS Number will be needed to achieve this consent preferences lookup.
Note: It is essential that a Toolkit Application works from an up-to-date value of the patient’s consent preferences – to ensure that the patient’s wishes are honoured and there are no loopholes due to time delays. Specifically, if the PDS Consent flag is used then its value must be freshly retrieved from PDS when needed and must not be locally cached beyond the current “session”. (“Session” would typically be defined as the logged on user’s session, however in non-interactive scenarios it might also be interpreted as a batch job, end-to-end message flow, or workflow instance). In addition, an application must ensure that any consent values populated into Toolkit messages are up-to-date, and not based on stale or cached data. Note: By default the responsibility is on the initiating application (ITK Client Application) which must ensure that the patient’s consent preferences are honoured. This responsibility may be relaxed only for specific circumstances where it can be clearly demonstrated that either the Toolkit Middleware or ITK Host Application(s) have alternative capabilities to
ensure that a consent check is done.","Applies to Applications that send clinical  data
",Must,SELECT ONE,"STATEMENT:  Statement should detail how the requirement is met.

-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to:
Client Applications that send clinical data 
Host Applications that provide response messages containg clinical data e.g. ADT Async

NOTE: Only relevant to applications that implement scenarios where clinical data may be shared across organisational boundaries. (e.g. CDA messages)

Optiions to be considered include:

1. The patients consent status with regard to sharing data across organisational boundaries is collected by the product. the value of this field can be checked at message creation time, and if consent has been withheld, the message would not be created and an appropriate log entry created to record this event.
2. Data can be sent if there is a local agreement that the receiver has alternative capabilities to ensure that a consent check is done and act accordingly.

NOTE: Document originators should be aware that  Non-coded CDA has an optional ‘consent’ class.If no explicit code is present within a consent class, then the presence of the document indicates a consent to share.",,"There are several means by which Toolkit Applications may be involved in sharing Detailed Care Record (DCR) information across organisational boundaries. For example:
  • An application belonging to one organisation may receive data via a Toolkit interface from an application belonging to a different organisation
  • An application may present a user interface (eg web portal) that is accessible to users from other organisations
  • An application may have other (non-Toolkit) integrations that exchange data with applications belonging to other organisations
In all cases a Toolkit application MUST ensure that, prior to allowing sharing of Detailed Care Record information across organisational boundaries, the patient’s consent preferences are checked and the results of this check are recorded. If the patient expresses Dissent then the DCR information sharing must be blocked.
The preferred approach to performing this check is that an application SHOULD make use of the patient’s DCR Consent preferences as recorded by the PDS Consent flag. This is intended to be a National setting that is honoured by all applications.
Alternatively, if access to the PDS Consent flag is not available, the application MUST offer an alternative approach. For example this might involve asking the patient directly, and recording their response.
Note: Options for accessing the PDS Consent Flag include:
  1. Direct access to PDS by a PDS Compliant application
  2. Making use of a “Get Consent” service offered by the Toolkit Middleware.
  3. Using a DCR consent flag contained in an incoming Toolkit message (subject to this being freshly populated, as described below)
In all cases knowledge of the patient’s NHS Number will be needed to achieve this consent preferences lookup.
Note: It is essential that a Toolkit Application works from an up-to-date value of the patient’s consent preferences – to ensure that the patient’s wishes are honoured and there are no loopholes due to time delays. Specifically, if the PDS Consent flag is used then its value must be freshly retrieved from PDS when needed and must not be locally cached beyond the current “session”. (“Session” would typically be defined as the logged on user’s session, however in non-interactive scenarios it might also be interpreted as a batch job, end-to-end message flow, or workflow instance). In addition, an application MUST ensure that any consent values populated into Toolkit messages are up-to-date, and not based on stale or cached data. 
Note: By default the responsibility is on the initiating application (Service Client Application) which MUST ensure that the patient’s consent preferences are honoured. This responsibility MAY be relaxed only for specific circumstances where it can be clearly demonstrated that either the Toolkit Middleware or Service Host Application(s) have alternative capabilities to ensure that a consent check is done.
",CLIENT; HOST& PATTERN1;,ALL,ALL,21
"ITK Client, Host and ITK Middleware Requirements",MOD-AIG-09,Additional Modules - Information Governance -NHS Number,"Toolkit Applications sending patient data via the Toolkit interfaces MUST include the patient’s traced NHS Number as an identifier, if this is known","NB
The NHS Number allows the patient to be identified on a National basis, and is thus important for enabling data sharing across organisational boundaries. Typically the message specifications will allow for multiple patient identifiers (including the NHS Number) to be included. This requirement therefore refines the message specification by stating that the traced NHS Number MUST be included as an identifier, if it is known. A traced NHS Number is the preferred patient identifier for interoperability within the NHS.
1
However, if only an unverified NHS Number is known, then this MAY be used if allowed by the Domain Message Specification being implemented.
2
Some Domain Message Specifications also allow a local identifier as a patient identifier. These SHOULD only be used where a traced NHS Number is not available.
3
Local patient identifiers MUST always carry the assigning authority name (as laid out in the Domain Message Specification).","Applies to Applications that send NHS number
",Must,SELECT ONE,"STATEMENT:  Statement should confirm that either 
a) the NHS Number is known and a trace has done to prove it is correct so it is included
b) the NHS number is known but a trace cannot be done so it is not included
c) the NHS number is not known so it is not included

Any of the above should be marked as Compliant.
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to:
Client Applications that send NHS numbers
SMSP Host (provides responses containing NHS Numbers)

The NHS Number allows the patient to be identified on a National basis, and is thus important for enabling data sharing across organisational boundaries.
Typically the message specifications will allow for multiple patient identifiers (including the NHS Number) to be included. A traced NHS Number is the preferred patient identifier for interoperability within the NHS. However, if only an unverified NHS Number is known, then this may be used if allowed by the Domain Message Specification being implemented. Some Domain Message Specifications also allow a local identifier as a patient identifier. These should only be used where a traced NHS Number is not available. Local patient identifiers MUST always carry the assigning authority name (as laid out in the Domain Message Specification).

Note: Only relevant where the NHS number is readily identifiable. If the NHS number is embedded within a PDF attachement for example, there is no expectation that that this NHS number would be extract and a trace done or that the NHS number would be removed from the PDF.",,"The NHS Number allows the patient to be identified on a National basis, and is thus important for enabling data sharing across organisational boundaries.
Typically the message specifications will allow for multiple patient identifiers (including the NHS Number) to be included. This requirement therefore refines the message specification by stating that the traced NHS Number MUST be included as an identifier, if it is known.
The NHS Number may not always be known. For example, an application may not be PDS
connected, or the individual patient may never have been traced. In this case it is clearly not possible to provide the NHS Number (as it is not known).
If an application has an NHS number that has not been traced then it may not be correct, and therefore this untraced NHS number MUST NOT be passed in Toolkit messages.",CLIENT; SMSP HOST; ,ALL,ALL,24
ITK Web Service Transport Requirements,WS-SEC-07,Web Services Standards - Messaging Security,Toolkit Implementations MUST be able to establish a requestor’s identity,"1
Toolkit Implementations MUST be able to use either TLS certificate subject or a WS-Security UsernameToken to establish a requestor’s identity.
2
Although Toolkit implementations can choose a single method of requestor identification, they SHOULD be able to use both.
3
If implemented, a WS-Security UsernameToken SHOULD (except for the local security context) be verified against the Subject field CN of the presented X.509 certificate used to secure the TLS connection, if these 2 values are not equal, the Toolkit Implementation MUST reject the message.",Always applies,Must,SELECT ONE,"STATEMENT: Please provide a statement confirming that the requirement is met and detailing how a requestor's identification is verified in the product i.e either by the TLS certificate subject or a WS-Security UsernameToken or both

EVIDENCE : Provide Audit Logs.
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: 
","This requirement applies to:
All Client Applications
All Host Applications 
All Middleware 
SMSP Host

",,NEW Requirement,ALL,ALL,WS,2
ITK Web Service Transport Requirements,WS-SEC-08,Web Services Standards - Messaging Security,"Toolkit Implementations MUST be able to authorise a service request, based on the Service and the Requestor’s identity","NB
Inbound messages must be able to be checked to ensure that the requestor is indeed allowed to invoke this service. Due to the application-based security approach, the requestor’s identity will usually be either that of the calling application or of an intermediary. As described in WS-SEC-07, for a Web Services implementation the identity of the requestor is provided by the Subject field of the certificate used to secure the TLS connection and / or the Username field of the WS-Security UsernameToken element.
1
The Toolkit Implementation MUST include logic that ensures that the requestor is authorised to invoke that service e.g. via an Access Control List. The Toolkit Implementation MUST reject any messages that fail this authorisation check.",Always applies ,Must,SELECT ONE,"STATEMENT: Please provide a statement confirming that: -
a) the requirement is met
b) that logic is included in the product that ensures that the requestor is authorised to invoke that service 
c) the product rejects any messages that fail this authorisation check

EVIDENCE : Provide Audit Logs.
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: 
","This requirement applies to:
All Client Applications
All Host Applications 
All Middleware 
SMSP Host

",,"Inbound messages must be able to be checked to ensure that the requestor is indeed allowed to invoke this service. Due to the application-based security approach, the requestor’s identity will usually be either that of the calling application or of an intermediary. For a Web Services implementation then the identity of the requestor must be authorised. A  compliant system:

- MUST be able to use either TLS certificate subject or a WS-Security UsernameToken, and SHOULD be able to use both. Before a TLS certificate can be trusted it MUST be checked against an up-to-date Certificate Revocation List, and be verified for currency (not expired) and authenticity (by checking its signing chain against one or more recognised Certificate Authorities). A certificate presented as part of TLS mutual authentication MAY have its subject Distinguished Name checked against an access control list or other reliable resource. A WS-Security UsernameToken MUST originate from a trusted source, and SHOULD (except for the local security context) be verified against the subject Distinguished Name of any presented TLS certificate.

- SHOULD be able to use the DistributionEnvelope auditIdentity. Such an identity MUST be from a trusted source. Systems populating the auditIdentity MUST guarantee an authenticated relationship between the identity and a user or source system. This authentication SHOULD be strong authentication (e.g. smart card) but MUST at least be via personal login via a password created and maintained in a suitably-strong manner. “Unattended” systems or those with no specific users MUST be secured. Whilst a remote system need not be able to resolve auditIdentity values directly, a populating system MUST be able to trace the source of a request to a specific local user or event.

A compliant system MUST maintain a log of auditable events including connections and requests for information both when successful and otherwise. Such audit logs SHOULD record origin and other requestor identity, operation, and details such as patient identifier where available.

NOTE: Requirement updated as part of base 11 Updates - see Cover tab.
",ALL,ALL,WS,2
ITK Web Service Transport Requirements,WS-ADR-06,"WS-Addressing
Addressing
Detailed Requirements",For the asynchronous invocation the “ReplyTo” element of the request message MUST be populated with the uri to be used. (And the “FaultTo” element MAY be populated).,"1
In scenarios when a non-anonymous ReplyTo address is supplied then the caller MAY also supply a FaultTo address. This is an alternative address to be used if the asynchronous response is a fault. (For example, if the implementation comprises a separate fault handler).
2
The ReplyTo address MUST contain a uri which is the address of the endpoint to be used for the SOAP response. (i.e. it MUST be the same as the “To” address which is subsequently used for the SOAP response).
3
It is only relevant to supply this element in the initiating SOAP request message and MUST NOT be supplied in any other scenario (e.g. in the SOAP response messages themselves
4
In the case of a synchronous request-response, then the response will be returned via the still-open HTTP connection. Thus the ReplyTo address MAY NOT be supplied in this scenario. If, despite this, it is populated then it MUST contain the standard anonymous uri “http://www.w3.org/2005/08/addressing/anonymous”.
5
If the ReplyTo address is omitted then the recipient MUST treat this in exactly the same way as if an anonymous ReplyTo had been supplied.
6
The ReplyTo address MAY contain the uri of a queue, if “pull” collection of the response from a queue is desired.
NB
The ReplyTo address is needed to support the asynchronous invocation pattern, by indicating where the SOAP response will be sent.",Applies to  systems sending messages (for both asychronous and synchronous invocation patterns),Must,SELECT ONE,"EVIDENCE: Execute all tests marked as ""applicable""  after filters have been applied on the Testcases Index  tab. 
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment:
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment:","This requirement applies to:
All Client Applications
All Host Applications 
All Middleware 
SMSP Host

NOTE: For a synchronous response the ReplyTo address MAY NOT be supplied, if it is populated then it MUST contain the standard anonymous uri “http://www.w3.org/2005/08/addressing/anonymous"".

NOTE: For asynchronous transactions, all validation checks performed by the TKW test that the ""Reply To"" address is populated correctly in the request message, therefore successful validation reports prove implementation. There are also several negative test cases defined to prove this requirement, they are SO_RPLYTO, SO_ANORPL, SO_AANRPL",,"The ReplyTo address is needed to support the asynchronous invocation pattern, by indicating where the SOAP response will be sent.
The ReplyTo address MUST contain a uri which is the address of the endpoint to be used for the SOAP response. (ie it MUST be the same as the “To” address which is subsequently used for the SOAP response)
It is only relevant to supply this element in the initiating SOAP request message and MUST NOT be supplied in any other scenario (eg in the SOAP response messages themselves)

In the case of a synchronous request-response, then the response will be returned via the still-open HTTP connection. Thus the ReplyTo address MAY NOT be supplied in this scenario. If, despite this, it is populated then it MUST contain the standard anonymous uri “http://www.w3.org/2005/08/addressing/anonymous"".
If the ReplyTo address is omitted then the recipient MUST treat this in exactly the same was as if an anonymous ReplyTo had been supplied.

In scenarios when a non-anonymous ReplyTo address is supplied then the caller MAY also supply a FaultTo address. This is an alternative address to be used if the asynchronous response is a fault. (For example, if the implementation comprises a separate fault handler).
Note that the ReplyTo address MAY contain the uri of a queue, if “pull” collection of the response from a queue is desired.

",ALL,ALL,WS,2
ITK Web Service Transport Requirements,WS-ADR-07,"WS-Addressing
Addressing
Detailed Requirements",For asynchronous invocation the “RelatesTo” element of the SOAP response MUST be populated with the MessageID of the initiating SOAP request messagee,"NB
The “RelatesTo” field in SOAP response message MUST contain the MessageID of the initiating SOAP request message, to assist the original requestor in correlating the asynchronous response.",Applies to  systems sending messages (for both asychronous and synchronous invocation patterns),Must,SELECT ONE,"EVIDENCE: Execute all tests marked as ""applicable""  after filters have been applied on the Testcases Index  tab. 
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment:
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment:","This requirement applies to:
All Client Applications
All Host Applications 
All Middleware 
SMSP Host

NOTE: Synchronous invocations must either omit the Relates To element or it MUST contain  the MessageID of the originating SOAP Request message. ",,"This relates to the asynchronous invocation pattern, where an initial Web Services call is made and the SOAP Response is returned via a separate HTTP connection.
The “RelatesTo” field in SOAP response message MUST contain the MessageID of the initiating SOAP request message, to assist the original requestor in correlating the asynchronous response.
Note that for the purposes of this requirement the phrase “SOAP Response” also includes a Fault response.
In the case of a synchronous request-response, then the response will be returned via the still-open HTTP connection. The RelatesTo field MAY be omitted in this scenario. If, despite this, it is populated then it MUST contain the MessageID of the originating SOAP Request message.


",ALL,ALL,WS,2
ITK Web Service Transport Requirements,WS-EXT-03,SOAP Header Extensibility,Implementations MUST raise a SOAP Fault if SOAP Header fields are encountered with the “mustUnderstand” attribute set which cannot be successfully processed,,Always applies,Must,SELECT ONE,"STATEMENT: Statement should state and explain if any local SOAP header extensions are used.

EVIDENCE: Execute SO_EXHDRJ from the Testcases Detailed tab 
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to:
All Client Applications 
All Host Applications 
All Middleware 
SMSP Host

",,"The SOAP mustUnderstand attribute allows identification of new header fields which are, in fact, essential for correct processing of the message. An unknown field with this attribute set therefore MUST NOT be ignored, but instead a SOAP Fault MUST be raised to indicate the problem. The default SOAP faultcode “MustUnderstand” MUST be used.
This is all as-per the standard SOAP specification.
",ALL,ALL,WS,2
Accreditation,ACC-MSG-01,Client Accreditation Requirement,Application Layer to Message Mapping,"Client suppliers must ensure that test messages created for the accreditation are suitably live like and exercise all appropriate message mappings which exist in a DMS. 
",Applies to Client Applications,Must,SELECT ONE,"STATEMENT  Statement should simply confirm that the requirement is met.
-----------------------------------------------------------------------------------------------------------------------
Supplier Comment: 
-----------------------------------------------------------------------------------------------------------------------
Accreditation Team Comment: ","This requirement applies to:
All Client Applications

NOTE: As accreditation is achieved at the service level rather than content level, you must provide confirmation that all test messages created have the right level of complexity and are suitably live like. 
",,"Client suppliers must ensure that test messages created for the accreditation are suitably live like and exercise all appropriate message mappings which exist in a DMS. 
",CLIENT,ALL,ALL,8
